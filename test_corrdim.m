load lorenz.dat; 
startPoint=[15576+10*60*512 15576+(10+8)*60*512 15576+(10+8+6)*60*512;
        19000+10*60*512 19000+(10+7.75)*60*512 19000+(10+7.75+6)*60*512;
        8794+10*60*512 8794+(10+7.25)*60*512 8794+(10+7.25+6)*60*512;
        5065+10*60*512 5065+(10+7.1)*60*512 5065+(10+7.1+6)*60*512;
        10571+10*60*512 10571+(10+7)*60*512 10571+(10+7+6)*60*512;
        7049+10*60*512 7049+(10+7.5)*60*512 7049+(10+7.5+6)*60*512;
        29681+10*60*512 29681+(10+7.15)*60*512 29681+(10+7.15+6)*60*512;
        11587+10*60*512 11587+(10+8.5)*60*512 11587+(10+8.5+6)*60*512;
        8821+10*60*512 8821+(10+7)*60*512 8821+(10+7+6)*60*512;
        40000+10*60*512 40000+(10+7.25)*60*512 40000+(10+7.25+6)*60*512];
start=startPoint(9,:);
y=HRVfeatureAtLoc('sub9_31_05_2013',start, 360, 512);
%y=lorenz(:,2);

figure; 
hold on;
%%
m=2:1:10;
slope=zeros(length(m),1);
count=1;
eps=0.001:0.001:2;
logeps=log2(eps);
tau=1;

[D2, Cm, epsilon]=corrdim(y.HRV,m(end),tau,eps);

%%
for i=m
    [CD, Cm, epsilon]=corrdim(y.HRV,i,tau,eps);
    logCm=log2(Cm);
    logCmS=logCm(logCm>-8 & logCm<-5);
    logepsS=logeps(logCm>-8 & logCm<-5);
    result=polyfit(logepsS,logCmS,1);
    slope(count)=result(1); 
    count=count+1;
end
hold off;